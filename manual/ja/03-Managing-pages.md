# ページの管理

以下の章ではContaoでページを管理する方法を説明しています。Contaoはページを基準としたコンテンツ管理システムなので、ページとサイト構造はウェブサイトの中心的な要素で、ページに関連していないコンテンツは決して表示されません。


## 構成要素

ページ、アーティクル、コンテンツ要素、モジュールが互いの関連の理解が、Contaoを学ぶための鍵となります。前に述べましたように、サイト構造はウェブサイトの中心的な要素です。ウェブサイトの訪問者は常にページをリクエストし、ノードを基盤としたCMSのようにアーティクルをリクエストするのではありません。

![](https://raw.github.com/contao/docs/3.0/manual/en/images/components.jpg)

アーティクルとレイアウトの2つが、もっとも重要なページの要素であることを略図は示しています。アーティクルがページのコンテンツを保持する一方、ページレイアウトはウェブサイトにどのように表示するかを定めています。ContaoのレイアウトはCSSに基づいていて、もちろん表を使用したレイアウトではありません。続く章では、スタイルシートとモジュールの作成方法、それらのページレイアウトへの結合方法、ページレイアウトを使用するページの作成方法について説明します。


## テーマ

テーマ管理はバージョン2.9の新しい機能ですが、実際は今までのContaoの一部だった部分から強化したインターフェイスに過ぎません。ウェブサイトのデザインは一般的にスタイルシート、フロントエンドモジュール、ページレイアウト、ファイル、テンプレートから構成されていて、、これらをContaoのバックエンドで管理できます。このやり方をまったく変えずに、これらのリソースのインポートとエクスポートする選択肢をテーマ管理は追加しただけです。


### テーマとフロントエンドテンプレートの違い

[テーマ][1]とフロントエンドテンプレートの主な違いは、フロントエンドテンプレートは完全に事前設定されたウェブサイトで、サンプルのサイト構造、アーティクル、コンテンツ要素、さらにユーザーとグループも含んでいます。テーマは対照的に、実際のウェブサイトのデザインだけを含んでいて、そのため既存のデータを失わずにインポートできます。

![](https://raw.github.com/contao/docs/3.0/manual/en/images/theme-manager.jpg)


### テーマの構成要素

テーマは[スタイルシート][2]、 [フロントエンドモジュール][3]、[ページレイアウト][4]のグループで、これらはすべてデータベースで保持していて、テーマのエクスポート機構が自動的に認識します。続く章で、これらの要素をさらに詳しく学習します。テーマはファイルディレクトリの画像とその他のファイルを通常は含んでいて、テンプレートのディレクトリのテンプレートを含む場合があります。しかし、これらのリソースはテーマに自動的に関連付けられず、このためエクスポートに含めるためにテーマの設定で追加しなければなりません。


![](https://raw.github.com/contao/docs/3.0/manual/en/images/theme-settings.jpg)


### テーマのエクスポートとインポート

テーマをエクスポートするには、単にテーマのエクスポートのボタンをクリックして.ctoファイルを使用しているコンピューターにダウンロードしてください。.ctoはContaoのテーマのための独自の拡張子ですが、実際のファイルはZIPアーカイブで.zipファイルを扱える、どのプログラムでも展開できます。テーマを再インポートするには、.ctoファイルをインストールしたCOntaoにアップロードして、テーマ管理を開いて「テーマのインポート」をクリックしてください。複数のテーマを一度にインポートできます。インポートが完了した後で、サイト構造に新しいテーマのページレイアウトを割り当てられます。


## スタイルシート

アクセスしやすいウェブサイトは常にCSSを使用してスタイルを形作らなければなりませんが、これがContaoがバックエンドで書式定義を管理する「スタイルシート」のモジュールを含めている理由です。様々なContaoの要素を参照するには、それらのclass名を知る必要があります。[コンテンツ要素のクラス][5]は(例えば、ce_textといった)ce_で始まり、[モジュールのクラス][3]は(例えば、mod_searchといった)mod_で始まります。よくわからない場合は、単にページのソースを見てください。

![](https://raw.github.com/contao/docs/3.0/manual/en/images/style-sheet.jpg)

それぞれのスタイルシートは1つ以上のメディアタイプと、Internet Exploreのバージョン(多数のバグの1つを修正が必要な場合)の両方またはどちらかに制限できます。書式定義の順序に注意してください、後の定義が前の書式定義を上書きするからです。

``` {.css}
/* 一般的な値を最初 */
.mod_search {
    margin:24px;
}

/* それからIE7用の値で上書き */
*:first-child+html .mod_search {
    margin:18px;
}
```

もし順序が逆だと、一般的な値をIEに特定のマージンで上書きしてしまいます。


## モジュール

フロントエンドモジュールは、ウェブサイトに殆どどのような種類の機能でも追加できます。Contaoのコアは様々なナビゲーションメニューの生成、ユーザーの登録と認証、ウェブサイトの検索、RSSフィードの取り込み、さらに様々なモジュールを含んでいます。モジュールを作成するには、バックエンドにログインして、ナビゲーションメニューから「テーマ」→「フロントエンドモジュール」と選択してください。

<table>
<tr>
  <th>モジュール</th>
  <th>CSSのクラス</th>
  <th>説明</th>
</tr>
<tr>
  <td>ナビゲーションメニュー</td>
  <td>mod_navigation</td>
  <td>サイト構造からナビゲーションメニューを生成します。</td>
</tr>
<tr>
  <td>カスタムナビゲーション</td>
  <td>mod_customnav</td>
  <td>独自のナビゲーションメニューを生成します。</td>
</tr>
<tr>
  <td>パンくずナビゲーション</td>
  <td>mod_breadcrumb</td>
  <td>パンくずナビゲーションのメニューを生成します。</td>
</tr>
<tr>
  <td>クイックナビゲーション</td>
  <td>mod_quicknav</td>
  <td>サイト構造からドロップダウンメニューを生成します。</td>
</tr>
<tr>
  <td>クイックリンク</td>
  <td>mod_quicklink</td>
  <td>独自ののドロップダウンメニューを生成します。</td>
</tr>
<tr>
  <td>ブックナビゲーション</td>
  <td>mod_booknav</td>
  <td>ブックナビゲーションメニューを生成します。</td>
</tr>
<tr>
  <td>アーティクルナビゲーション</td>
  <td>mod_article_nav</td>
  <td>アーティクルをナビゲートするページネーションのメニューを生成します。</td>
</tr>
<tr>
  <td>サイトマップ</td>
  <td>mod_sitemap</td>
  <td>サイト構造のすべてのページの一覧を生成します。</td>
</tr>
<tr>
  <td>ログインフォーム</td>
  <td>mod_login</td>
  <td>ログインのフォームを生成します。</td>
</tr>
<tr>
  <td>自動ログアウト</td>
  <td>-</td>
  <td>ユーザーを自動的にログアウトします。</td>
</tr>
<tr>
  <td>個人データ</td>
  <td>mod_personalData</td>
  <td>ユーザーの個人データを編集するフォームを生成します。</td>
</tr>
<tr>
  <td>登録</td>
  <td>mod_registration</td>
  <td>ユーザーの登録フォームを生成します。</td>
</tr>
<tr>
  <td>パスワードの紛失</td>
  <td>mod_password</td>
  <td>新しいパスワードを要求するフォームを生成します。</td>
</tr>
<tr>
  <td>アカウントの廃止</td>
  <td>mod_closeAccount</td>
  <td>メンバーのアカウントを削除するフォームを生成します。</td>
</tr>
<tr>
  <td>ニュースリスト</td>
  <td>mod_newslist</td>
  <td>ニュース項目のリストをページに追加します。</td>
</tr>
<tr>
  <td>ニュースリーダー</td>
  <td>mod_newsreader</td>
  <td>ニュース項目の詳細を表示します。</td>
</tr>
<tr>
  <td>ニュースアーカイブ</td>
  <td>mod_newsarchive</td>
  <td>ニュースアーカイブをページに追加します。</td>
</tr>
<tr>
  <td>ニュースアーカイブメニュー</td>
  <td>mod_newsmenu</td>
  <td>ニュースアーカイブを閲覧するためのナビゲーションメニューを生成します。</td>
</tr>
<tr>
  <td>カレンダー</td>
  <td>mod_calendar</td>
  <td>カレンダーをページに追加します。</td>
</tr>
<tr>
  <td>イベントリーダー</td>
  <td>mod_eventreader</td>
  <td>イベントの詳細を表示します。</td>
</tr>
<tr>
  <td>イベントリスト</td>
  <td>mod_eventlist</td>
  <td>イベントのリストをページに追加します。</td>
</tr>
<tr>
  <td>イベントリストメニュー</td>
  <td>mod_eventmenu</td>
  <td>イベントのリストを閲覧するナビゲーションのメニューを生成します。</td>
</tr>
<tr>
  <td>登録の申し込み</td>
  <td>mod_subscribe</td>
  <td>1つ以上のチャンネルの登録を申し込みできるフォームを生成します。</td>
</tr>
<tr>
  <td>解除の申し込み</td>
  <td>mod_unsubscribe</td>
  <td>1つ以上のチャンネルの解除を申し込みできるフォームを生成します。</td>
</tr>
<tr>
  <td>ニュースレターリスト</td>
  <td>mod_nl_list</td>
  <td>ニュースレターのリストをページに追加します。</td>
</tr>
<tr>
  <td>ニュースレターリーダー</td>
  <td>mod_nl_reader</td>
  <td>ニュースレターの詳細を表示します。</td>
</tr>
<tr>
  <td>FAQリスト</td>
  <td>mod_faqlist</td>
  <td>よくある質問のリストをページに追加します。</td>
</tr>
<tr>
  <td>FAQリーダー</td>
  <td>mod_faqreader</td>
  <td>よくある質問の回答を表示します。</td>
</tr>
<tr>
  <td>FAQページ</td>
  <td>mod_faqpage</td>
  <td>FAQリストとFAQリーダーを同一のページで表示します。</td>
</tr>
<tr>
  <td>フォーム</td>
  <td>mod_form</td>
  <td>フォームをページに追加します。</td>
</tr>
<tr>
  <td>検索エンジン</td>
  <td>mod_search</td>
  <td>検索フォームをページに追加します。</td>
</tr>
<tr>
  <td>コメント</td>
  <td>mod_comments</td>
  <td>コメントのフォームをページに追加します。</td>
</tr>
<tr>
  <td>リスティング</td>
  <td>mod_listing</td>
  <td>テーブルのレコードを一覧します。</td>
</tr>
<tr>
  <td>Flash動画</td>
  <td>mod_flash</td>
  <td>Flash動画をページに埋め込みます。</td>
</tr>
<tr>
  <td>アーティクルリスト</td>
  <td>mod_article_list</td>
  <td>一列のアーティルクの一覧を生成します。</td>
</tr>
<tr>
  <td>ランダムな画像</td>
  <td>mod_random_image</td>
  <td>無作為に選択した画像をページに追加します。</td>
</tr>
<tr>
  <td>カスタムHTML</td>
  <td>-</td>
  <td>独自のHTMLコードを追加します。</td>
</tr>
<tr>
  <td>RSSリーダー</td>
  <td>mod_rss_reader</td>
  <td>RSSフィードをページに追加します。</td>
</tr>
</table>


### アクセス制御

それぞれのフロントエンドモジュールは保護してウェブサイドでゲストだけ、または特定のグループのメンバーだけに表示するようにできます。

![](https://raw.github.com/contao/docs/3.0/manual/en/images/protected-module.jpg)


## ページレイアウト

ページレイアウトは例えば列の数や全体の幅といった基本的なページの設定と、それぞれの列にどのフロントエンドモジュールを表示するか定めます。また、ページに含めるスタイルシート、RSSやATOMのフィードのリンク、GoogleアナリティクスのIDの関連付け、対話的な要素とプラグインに必要な任意のJavaScriptのコードを追加できます。ContaoのCSSのフレームワークはブラウザーのウィンドウを自動的にいくつかのレイアウトセクションに分割して、次の図のようにそれぞれのセクションに割り当てたモジュールを下図のように表示します。


![](https://raw.github.com/contao/docs/3.0/manual/en/images/front-end-structure.jpg)

![](https://raw.github.com/contao/docs/3.0/manual/en/images/front-end-modules.jpg)

これは、ページレイアウトを作成するまでに含めるすべてのスタイルシートとフロントエンドモジュールを作成が必要なことを意味します。従って、以下の順序でリソースを作成することをお勧めします:

* 必要なフロントエンドモジュールの作成
* 必要なスタイルシートの作成
* ニュースアーカイブやカレンダーが必要であれば作成
* 新しいページレイアウトを作成して、これらの構成要素を結合


## ページの種類

ページの種類は、ページがコンテンツを表示する、他のページに移動する、ページツリー内で新しいウェブサイトの開始点とするといったことを決定します。Contaoは以下に説明する、6つの異なったページの種類をサポートしています。

<table>
<tr>
  <th>ページの種類</th>
  <th>説明</th>
</tr>
<tr>
  <td>通常ページ page</td>
  <td>通常ページはアーティクルとコンテンツ要素を含みます。静的なHTMLのページのように振る舞います。</td>
</tr>
<tr>
  <td>外部リダイレクト</td>
  <td>この種類のページは外部のウェブサイトに自動的にリダイレクトします。ハイパーリンクのように動作します。</td>
</tr>
<tr>
  <td>内部リダイレクト</td>
  <td>この種類のページはサイト構造の中の他のページに自動的に移動します。</td>
</tr>
<tr>
  <td>ウェブサイトのルート</td>
  <td>この種類のページはページ構造内で新しいウェブサイトを開始する点を示します。</td>
</tr>
<tr>
  <td>403 アクセスの拒否</td>
  <td>ユーザーが権限を持たない保護されたページを要求した場合に、403のエラーページを代わりに読み込みます。</td>
</tr>
<tr>
  <td>404 存在しないページ</td>
  <td>ユーザーが存在しないページを要求した場合に、404のエラーページを代わりに読み込みます。</td>
</tr>
</table>


### 複数ドメインのモード

Contaoはサイト構造に複数のウェブサイトをサポートしていて、DNSと言語の設定に応じて訪問者を特定のウェブサイトのルートに自動的に移動します。"www.company.com"というドメインを使用している二か国語の企業のウェブサイトと、"www.personal.website.com"というドメインを使用している小規模の個人的なウェブサイトを運営しているとした場合、3つのウェブサイトのルートが必要です:

<table>
<tr>
  <th>種類</th>
  <th>DNS</th>
  <th>言語コード</th>
  <th>代替の言語</th>
</tr>
<tr>
  <td>ドイツ語版の企業のサイトの</td>
  <td>なし</td>
  <td>de</td>
  <td>いいえ</td>
</tr>
<tr>
  <td>英語版の企業のサイト</td>
  <td>なし</td>
  <td>en</td>
  <td>はい</td>
</tr>
<tr>
  <td>個人のウェブサイト</td>
  <td>personal-website.com</td>
  <td>de</td>
  <td>はい</td>
</tr>
</table>

次の表は、ドメインとアクセスするブラウザーの言語に対応して表示するページを示します。

<table>
<tr>
  <th>ドメイン</th>
  <th>ブラウザーの言語</th>
  <th>表示先</th>
</tr>
<tr>
  <td>www.company.com</td>
  <td>英語</td>
  <td>英語版の企業のサイト</td>
</tr>
<tr>
  <td>www.company.com</td>
  <td>ドイツ語</td>
  <td>ドイツ語版の企業のサイト</td>
</tr>
<tr>
  <td>www.company.com</td>
  <td>スペイン語</td>
  <td>英語版の企業のサイト</td>
</tr>
<tr>
  <td>www.personal-website.com</td>
  <td>どれでも</td>
  <td>個人のウェブサイト</td>
</tr>
</table>

「言語の代替」のオプションを有効にしていないと、個人のウェブサイトはドイツ語を話すユーザーだけしか利用できないことに注意してください!


### アクセス権

アクセス権はバックエンドのユーザーがページとそのアーティクルに行えることを定義します。特定のフロントエンドのユーザだけがアクセスできる保護されたページとは無関係です! Unixのファイルの権限システムと同様に、3つの権限レベルがあります:

* ページの所有者としてアクセス
* ページを所有するグループのメンバーとしてアクセス
* 特別な権限のないユーザーとしてアクセス

それぞれのレベルに異なる権限を設定できます。初期状態では、ページの所有者はページ自身とそのアーティクルを編集でき、ページを所有するグループのメンバーはアーティクルだけを編集でき、特別な権限のないユーザーは書き込み権限を一切持ちません。

![](https://raw.github.com/contao/docs/3.0/manual/en/images/access-rights.jpg)


[1]: https://contao.org/en/contao-themes-and-templates.html
[2]: 03-Managing-pages.md#style-sheets
[3]: 03-Managing-pages.md#modules
[4]: 03-Managing-pages.md#page-layouts
[5]: 04-Managing-content.md#articles
